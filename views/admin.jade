extends layout

block content
    if session.role != "Admin" && session.role != "Manager" && session.role != "IT User"
        script(type='text/javascript').
            console.log("error: not logged in");
            window.location.replace('/');
    else
        script(src='/javascripts/socket.io.js')
        script(src='/javascripts/ticket_client.js')
        script(type='text/javascript').
            var sessionUser = "#{session.user}";
            var sessionRole = "#{session.role}";
            var sessionDepts = "#{session.depts}";
        - var testArray = [1, 2, "c"];
        - var testJson = {a: 1, b: 2};

        div.navbar.navbar-inverse.navbar-fixed-top(role='navigation')
            div.container-fluid
                div.navbar-header
                    button.navbar-toggle(type='button', data-toggle='collapse', data-target='.navbar-collapse')
                        span.sr-only Toggle Navigation
                        span.icon-bar
                        span.icon-bar
                        span.icon-bar
                    a.navbar-brand(href='#') Wei To Ticket
                div.navbar-collapse.collapse
                    ul.nav.navbar-nav.navbar-right
                        li
                            a(href='/logout') Logout
                        li
                            a(href='#') Dashboard
                        li
                            a(href='#') Settings
                        li
                            a(href='#') Profile
                        li
                            a(href='#') Help

        div.container-fluid(ng-app='admin')
            div.row
                div.col-sm-3.col-md-2.sidebar.t-spaceIcons
                    h3 Overview
                    ul.nav.nav-sidebar
                        li(ui-sref-active='active')
                            a(ui-sref='home')
                                span.glyphicon.glyphicon-cloud
                                | Welcome
                        li(ui-sref-active='active')
                            // different parameters are passed into viewtickets depending on role
                            // managers can only view tickets in their own department
                            // it users can only view assigned tickets
                            //a(ui-sref='viewtickets({filters: #{session.filters}, searchParams: null, includeCompleted: include, includeExpired: include, amount: null})')
                            a(ui-sref='viewtickets({testVar: "#{session.depts}", testVar2: "#{testArray}"})')
                                span.glyphicon.glyphicon-th-large
                                | View Tickets
                        li(ui-sref-active='active')
                            a(ui-sref='')
                                span.glyphicon.glyphicon-plus
                                | New Ticket
                        li(ui-sref-active='active')
                            a(ui-sref='')
                                span.glyphicon.glyphicon-search
                                | Search Ticket
                    h3 Control Panel
                    ul.nav.nav-sidebar
                        li(ui-sref-active='active')
                            a(ui-sref='viewusers')
                                span.glyphicon.glyphicon-user
                                | View Users
                        li(ui-sref-active='active')
                            a(ui-sref='newuser')
                                span.glyphicon.glyphicon-certificate
                                | New User
                        li(ui-sref-active='active')
                            a(ui-sref='')
                                span.glyphicon.glyphicon-envelope
                                | Mail Settings
                        li(ui-sref-active='active')
                            a(ui-sref='')
                                span.glyphicon.glyphicon-cog
                                | Other Settings
                    hr
                    div.t-bottom
                        p.text-center Created By The Wei Team
                div.col-sm-9.col-sm-offset-3.col-md-10.col-md-offset-2.main
                    div(ui-view)